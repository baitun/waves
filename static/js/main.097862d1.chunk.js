(window.webpackJsonpwaves=window.webpackJsonpwaves||[]).push([[0],{123:function(e,t,n){e.exports={cards:"Cards_cards__314Rx"}},136:function(e,t){},233:function(e,t,n){e.exports={section:"Section_section__Ap5Zy"}},251:function(e,t,n){e.exports=n(490)},256:function(e,t,n){},47:function(e,t,n){e.exports={card:"Card_card__1eE8R",add:"Card_add__1pgKF",title:"Card_title__2pVhP",attributes:"Card_attributes__16E1C"}},490:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(8),i=n.n(c),u=(n(256),n(27)),o=n(498),l=n(26),s=n(11),p=n.n(s),m=n(170),f=n(22),d=(n(130),Math.pow(10,8));function v(e){return fetch(e).then(function(e){return e.json()})}function b(e){return fetch(e).then(function(e){return e.json()})}var h="3N4vYCshKfrNXYTmg4Z7af2wKprhDsLBqP2",E="https://nodes-testnet.wavesnodes.com";function y(e){return"".concat(E,"/").concat(e)}function w(e){return y("addresses/data/".concat(h,"?matches=").concat(e))}function O(){return g.apply(this,arguments)}function g(){return(g=Object(f.a)(p.a.mark(function e(){var t,n,a,r,c=arguments;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:".*",e.next=3,v(w(t+"_organizer"));case 3:for(n=e.sent,a=[],r=0;r<n.length;r++)a.push.apply(a,Object(m.a)(n[r].value.trim().split(" ")));return e.abrupt("return",a);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j(e){return k.apply(this,arguments)}function k(){return(k=Object(f.a)(p.a.mark(function e(t){var n,a,r;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(w(t+"_bidder"));case 2:for(n=e.sent,a=[],r=0;r<n.length;r++)a.push.apply(a,Object(m.a)(n[r].value.trim().split(" ")));return e.abrupt("return",a);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function S(e){return x.apply(this,arguments)}function x(){return(x=Object(f.a)(p.a.mark(function e(t){var n,a,r,c,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(w(t+"_.*"));case 2:for(n=e.sent,a={id:n[0].key.split("_")[0]},r=0;r<n.length;r++)c=n[r].key.substr(n[r].key.indexOf("_")+1),i=n[r].value,a[c]=i;return e.abrupt("return",a);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function I(){return(I=Object(f.a)(p.a.mark(function e(){var t,n,a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:return t=e.sent,n=t.map(function(e){return S(e)}),e.next=6,Promise.all(n);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _(e){return C.apply(this,arguments)}function C(){return(C=Object(f.a)(p.a.mark(function e(t){var n,a,r;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(t);case 2:return n=e.sent,a=n.map(function(e){return S(e)}),e.next=6,Promise.all(a);case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function A(){return(A=Object(f.a)(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_(t).then(function(e){return e.map(function(e){return{auctionId:e.id,hash:e[e.id+t+"_bid_hash"],deposit:e.deposit||0}})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function T(){return(T=Object(f.a)(p.a.mark(function e(t){var n,a,r;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(t);case 2:return n=e.sent,a=n.map(function(e){return S(e)}),e.next=6,Promise.all(a);case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function P(e,t){return F.apply(this,arguments)}function F(){return(F=Object(f.a)(p.a.mark(function e(t,n){var a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={type:3,data:{name:t.name,description:t.imageUrl,quantity:1,precision:0,reissuable:!1,fee:{tokens:"0.001",assetId:"WAVES"}}},e.abrupt("return",n(a).then(JSON.parse));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function N(e){return W.apply(this,arguments)}function W(){return(W=Object(f.a)(p.a.mark(function e(t){var n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=y("assets/nft/".concat(t,"/limit/100")),e.abrupt("return",b(n));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function D(e){return L.apply(this,arguments)}function L(){return(L=Object(f.a)(p.a.mark(function e(t){var n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=y("assets/details/".concat(t)),e.abrupt("return",b(n));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function U(e,t){return K.apply(this,arguments)}function K(){return(K=Object(f.a)(p.a.mark(function e(t,n){var a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.startPrice>=t.deposit)){e.next=2;break}throw new Error("start price should be >= deposit");case 2:return a={type:16,data:{fee:{tokens:"0.005",assetId:"WAVES"},dApp:h,call:{function:"startAuction",args:[{type:"integer",value:t.duration},{type:"integer",value:t.startPrice*d},{type:"string",value:t.priceAssetId||"WAVES"},{type:"integer",value:t.deposit*d}]},payment:[{tokens:1,assetId:t.assetId}]}},e.abrupt("return",n(a).then(JSON.parse));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var M=function(e){WavesKeeper.initialPromise.then(function(t){e(t)})},z=n(60),R=n(495),V=n(492),B=n(233),H=n.n(B),J=function(e){var t=e.children;return r.a.createElement("div",{className:H.a.section},t)},Y=[{title:"Auction ID",dataIndex:""},{title:"Start price",dataIndex:"startPrice"},{title:"Deposit",dataIndex:"deposit"},{title:"My bid",dataIndex:"myBid"},{title:"Status",dataIndex:"Status"},{title:"Actions",render:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(z.a,null,"UP"))}}],Z=function(){var e=Object(a.useState)([]),t=Object(u.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)(function(){M(function(e){e.publicState().then(function(e){var t=e.account&&e.account.address;t&&function(e){return A.apply(this,arguments)}(t).then(function(e){c(e)})})})},[]),r.a.createElement(J,null,r.a.createElement(R.a.Title,{level:1},"My bids"),r.a.createElement(V.a,{columns:Y,dataSource:n,pagination:!1,rowKey:"auctionId"}))},q=n(9),G=n(90),X=n.n(G);function Q(e){return $.apply(this,arguments)}function $(){return($=Object(f.a)(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",D(t.lot_assetId||"").then(function(e){return e.description}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ee=n(47),te=n.n(ee),ne=function(e){var t=e.item,n=Object(a.useState)(""),c=Object(u.a)(n,2),i=c[0],o=c[1];return Object(a.useEffect)(function(){Q(t).then(function(e){o(e)})},[t]),r.a.createElement("div",{className:te.a.card,onClick:function(){return Object(l.navigate)("/waves/auction/".concat(t.id))}},r.a.createElement("img",{src:i,alt:""}),r.a.createElement(R.a.Title,{className:te.a.title,level:4},t.id),r.a.createElement("div",{className:te.a.attributes},r.a.createElement("div",null,r.a.createElement(q.a,{type:"user"})," ",t.organizer),r.a.createElement("div",null,r.a.createElement(q.a,{type:"clock-circle"})," Ends ",X()().to(0)),r.a.createElement("div",null,r.a.createElement(q.a,{type:"money-collect"})," ",t.startPrice," Waves"),r.a.createElement("div",null,r.a.createElement(q.a,{type:"number"})," ",t.unrevealed_count," bids")))},ae=function(e){return r.a.createElement("div",Object.assign({className:"".concat(te.a.card," ").concat(te.a.add)},e),r.a.createElement(q.a,{type:"plus"}))},re=n(123),ce=n.n(re),ie=function(e){var t=e.auctions;return r.a.createElement("div",{className:ce.a.cards},r.a.createElement(ae,{onClick:function(){return Object(l.navigate)("/waves/create/lot")},title:"Create a new lot"}),t.map(function(e){return r.a.createElement(ne,{key:e.id,item:e})}))},ue=function(e){var t=e.lot;return r.a.createElement("div",{className:te.a.card,onClick:function(){return Object(l.navigate)("/waves/lot/".concat(t.id))}},r.a.createElement("img",{src:t.imageUrl,alt:""}),r.a.createElement(R.a.Text,null,t.id.substr(20,t.id.length)),r.a.createElement(R.a.Title,{className:te.a.title,level:4},t.name))},oe=function(){var e=Object(a.useState)([]),t=Object(u.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)(function(){M(function(e){e.publicState().then(function(e){var t=e.account&&e.account.address;t&&N(t).then(function(e){c(e)})})})},[]),r.a.createElement("div",{className:ce.a.cards},r.a.createElement(ae,{onClick:function(){return Object(l.navigate)("/waves/create/lot")},title:"Create a new lot"}),n.map(function(e){return r.a.createElement(ue,{key:e.id,lot:{name:e.name,imageUrl:e.description,id:e.id}})}))},le=n(124),se=n(125),pe=n(127),me=n(126),fe=n(128),de=n(95),ve=n(494),be=n(496),he=de.a.Option,Ee=function(e){function t(e){var n;return Object(le.a)(this,t),(n=Object(pe.a)(this,Object(me.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),n.props.form.validateFields(function(e,t){e||(console.log("Received values of form: ",t),M(function(){var e=Object(f.a)(p.a.mark(function e(n){var a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U({assetId:t["select-lot"],duration:t.duration,startPrice:t["input-number-start-price"],priceAssetId:"WAVES",deposit:t["input-number-deposit"]},n.signAndPublishTransaction);case 2:a=e.sent,console.info("Created asset: "+a.id+" waiting for tx");case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()))})},n.normFile=function(e){return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.fileList},n.state={lots:[]},n}return Object(fe.a)(t,e),Object(se.a)(t,[{key:"componentDidMount",value:function(){var e=this;M(function(t){t.publicState().then(function(t){var n=t.account&&t.account.address;n&&N(n).then(function(t){e.setState({lots:t})})})})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.lots;return r.a.createElement(J,null,r.a.createElement(R.a.Title,null,"Creating an auction"),r.a.createElement(ve.a,Object.assign({},{labelCol:{span:6},wrapperCol:{span:14}},{onSubmit:this.handleSubmit}),r.a.createElement(ve.a.Item,{label:"Lot",hasFeedback:!0},e("select-lot",{})(r.a.createElement(de.a,null,t&&t.map(function(e){return r.a.createElement(he,{value:e.id,key:e.id},e.name)}))),r.a.createElement(z.a,{onClick:function(){return Object(l.navigate)("/waves/create/lot")}},"Create Lot")),r.a.createElement(ve.a.Item,{label:"Duration"},e("duration",{})(r.a.createElement(be.a,{step:1}))),r.a.createElement(ve.a.Item,{label:"Start price"},e("input-number-start-price",{})(r.a.createElement(be.a,{step:.01}))),r.a.createElement(ve.a.Item,{label:"Deposit"},e("input-number-deposit",{})(r.a.createElement(be.a,{step:.01}))),r.a.createElement(ve.a.Item,{wrapperCol:{span:12,offset:6}},r.a.createElement(z.a,{type:"primary",htmlType:"submit"},"Save auction"))))}}]),t}(r.a.Component),ye=ve.a.create({name:"validate_other"})(Ee),we=n(497),Oe=n(493),ge=function(e){function t(){var e,n;Object(le.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(pe.a)(this,(e=Object(me.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault(),n.props.form.validateFields(function(e,t){e||(console.log("Received values of form: ",t),M(function(){var e=Object(f.a)(p.a.mark(function e(n){var a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P({name:t["input-name"],imageUrl:t.upload[0].response.url},n.signAndPublishTransaction);case 2:a=e.sent,console.info("Created asset: "+a.id+" waiting for tx");case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()))})},n.normFile=function(e){return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.fileList},n}return Object(fe.a)(t,e),Object(se.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement(J,null,r.a.createElement(R.a.Title,null,"Creating a Lot"),r.a.createElement(ve.a,Object.assign({},{labelCol:{span:6},wrapperCol:{span:14}},{onSubmit:this.handleSubmit}),r.a.createElement(ve.a.Item,{label:"Lot name"},e("input-name",{})(r.a.createElement(we.a,null))),r.a.createElement(ve.a.Item,{label:"Image for lot"},e("upload",{valuePropName:"fileList",getValueFromEvent:this.normFile})(r.a.createElement(Oe.a,{name:"image",action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",listType:"picture",accept:"image/*"},r.a.createElement(z.a,null,r.a.createElement(q.a,{type:"upload"})," Click to upload")))),r.a.createElement(ve.a.Item,{wrapperCol:{span:12,offset:6}},r.a.createElement(z.a,{type:"primary",htmlType:"submit"},"Save Lot"))))}}]),t}(r.a.Component),je=ve.a.create({name:"validate_other"})(ge),ke=[{title:"key",dataIndex:"key"},{title:"value",dataIndex:"value"}],Se=function(e){var t=e.item,n={"Auction id ":t.id,"Max bid ":t.deposit,"Amount ":t.lot_amount,"Lot id ":t.lot_assetId,"Organizer address ":t.organizer,"Currency ":t.priceAssetId,"Start bid ":t.startPrice,"Time left for bids ":"@TODO","Second price":t.second_price?t.second_price:"Will be known after time left for bids complete","Top price ":t.top_price?t.top_price:"Will be known after time left for bids completed","Unrevealed count":t.unrevealed_count?t.unrevealed_count:"Will be known after time left for bids completed","Time left for reveal bids":"@TODO closing_start - today",Settle:t.settle?"Winner took the prize":"The prize is held by the organizer"},a=Object.entries(n).map(function(e){var t=Object(u.a)(e,2);return{key:t[0],value:t[1]}});return r.a.createElement(V.a,{columns:ke,dataSource:a,pagination:!1,showHeader:!1})},xe=function(e){var t=e.auction,n=e.state,c=Object(a.useState)(0),i=Object(u.a)(c,2),o=i[0],l=i[1],s=Object(a.useState)(""),p=Object(u.a)(s,2),m=p[0],f=p[1];return Object(a.useEffect)(function(){t&&Q(t).then(function(e){f(e)})},[t]),void 0===t?r.a.createElement(r.a.Fragment,null,"Auction not found"):r.a.createElement(J,null,r.a.createElement(R.a.Title,{level:1},t.id),r.a.createElement("img",{src:m,alt:""}),r.a.createElement(Se,{item:t}),r.a.createElement("br",null),r.a.createElement("br",null),n.account.address===t.organizer?r.a.createElement(r.a.Fragment,null,r.a.createElement(z.a,{type:"primary"},"SETTLE")):r.a.createElement(r.a.Fragment,null,r.a.createElement(be.a,{value:o,min:0,formatter:function(e){return e?(+e/100).toFixed(2):""},parser:function(e){return e?100*parseFloat(e):0},onChange:function(e){return e&&l(e)}})," ",r.a.createElement(z.a,{type:"primary"},"Bid")))},Ie=function(e){var t=e.id,n=Object(a.useState)(),c=Object(u.a)(n,2),i=c[0],o=c[1];return Object(a.useEffect)(function(){M(function(e){e.publicState().then(function(e){var n=e.account&&e.account.address;n&&N(n).then(function(e){o(e.map(function(e){return{id:e.id,name:e.name,imageUrl:e.description}}).find(function(e){return e.id===t}))})})})},[t]),void 0===i?r.a.createElement(r.a.Fragment,null,"Lot not found"):r.a.createElement(J,null,r.a.createElement(R.a.Title,{level:1},i.name),r.a.createElement("img",{src:i.imageUrl,alt:""}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(z.a,{onClick:function(){return Object(l.navigate)("/waves/create/auction")},type:"primary"},"Send to auction"))},_e=n(491),Ce=n(169),Ae=function(e){var t,n=e.state,a=Object(l.usePath)();return r.a.createElement(_e.a.Header,null,r.a.createElement("div",{style:{float:"left",color:"white",marginRight:20}},"WAVES BIDS"),r.a.createElement(Ce.a,{theme:"dark",mode:"horizontal",selectedKeys:[a],style:{lineHeight:"64px"},onClick:function(e){Object(l.navigate)(e.key)}},r.a.createElement(Ce.a.Item,{key:"/waves/"},"All auctions"),r.a.createElement(Ce.a.SubMenu,{title:"Create"},r.a.createElement(Ce.a.Item,{key:"/waves/create/lot"},"Create lot"),r.a.createElement(Ce.a.Item,{key:"/waves/create/auction"},"Create auction")),r.a.createElement(Ce.a.SubMenu,{title:r.a.createElement("span",{className:"submenu-title-wrapper"},r.a.createElement(q.a,{type:"user"}),n&&n.account&&n.account.name||"NOT AUTHORIZED"),style:{float:"right"}},r.a.createElement(Ce.a.Item,{key:"/waves/auctions"},"My auctions"),r.a.createElement(Ce.a.Item,{key:"/waves/bids"},"My bids"),r.a.createElement(Ce.a.Item,{key:"/waves/lots"},"My lots"),r.a.createElement(Ce.a.ItemGroup,{title:"Info"},r.a.createElement(Ce.a.Item,{disabled:!0,key:"adress"},n&&n.account&&n.account.address),r.a.createElement(Ce.a.Item,{disabled:!0,key:"balance-available"},"Balance:"," ",n&&n.account&&(t=n.account.balance.available,(parseInt(""+t)/d).toString())," ","WAVES"),r.a.createElement(Ce.a.Item,{disabled:!0,key:"network"},"Network: ",n&&n.account&&n.account.network)))))},Te=function(e){var t=e.children,n=e.state;return r.a.createElement(_e.a,{className:"layout"},r.a.createElement(Ae,{state:n}),r.a.createElement(_e.a.Content,null,t),r.a.createElement(_e.a.Footer,null))},Pe=function(){Object(l.useRedirect)("/","/waves/");var e=Object(a.useState)(),t=Object(u.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(),s=Object(u.a)(i,2),p=s[0],m=s[1],f=Object(a.useState)(),d=Object(u.a)(f,2),v=d[0],b=d[1];Object(a.useEffect)(function(){new Promise(function(e,t){window.onload=function(){if("undefined"===typeof WavesKeeper)return t("Keeper is not installed!");WavesKeeper.initialPromise.then(function(t){t.publicState().then(function(t){console.log({state:t}),e(t)})})}}).then(function(e){c(e)}).catch(function(e){o.a.error({message:e,description:"You need to install and configure Waves Keeper chrome extension in order to use this site!"})})},[]),Object(a.useEffect)(function(){if(n){if(!n.account)throw new Error("There is no `account` field in `state` object");(function(){return I.apply(this,arguments)})().then(function(e){m(e)})}},[n]),Object(a.useEffect)(function(){if(n){if(!n.account)throw new Error("There is no `account` field in `state` object");(function(e){return T.apply(this,arguments)})(n.account.address).then(function(e){b(e)})}},[n]);var h={"/waves/":function(){return r.a.createElement(ie,{auctions:p||[]})},"/waves/auctions":function(){return r.a.createElement(ie,{auctions:v||[]})},"/waves/lots":function(){return r.a.createElement(oe,null)},"/waves/bids":function(){return r.a.createElement(Z,null)},"/waves/create/lot":function(){return r.a.createElement(je,null)},"/waves/create/auction":function(){return r.a.createElement(ye,null)},"/waves/auction/:id":function(e){var t=e.id;return p&&r.a.createElement(xe,{state:n,auction:p.find(function(e){return e.id===t})})},"/waves/lot/:id":function(e){var t=e.id;return r.a.createElement(Ie,{id:t})}},E=Object(l.useRoutes)(h);return r.a.createElement(Te,{state:n},E||"404. Page not found")};i.a.render(r.a.createElement(Pe,null),document.getElementById("root"))}},[[251,1,2]]]);
//# sourceMappingURL=main.097862d1.chunk.js.map